div.study-card
  div.counter-info = "もう#{@count}つ"
  h1.show-answer-button = @progress.title
  div.answer
    div.answer-buttons
      - ed = @progress.deck
      div.answer-button.red data-value="incorrect"
        ' NO
        div.answer-details = "#{ed} → #{ed>0 ? ed-1 : 0} (~#{SRS_RANGES[1][1]} days)"
      div.answer-button.blue data-value="soso"
        ' SO&#8209;SO
        div.answer-details = "#{ed} → #{ed} (~#{SRS_RANGES[ed>7 ? 7 : ed][1]} days)"
      div.answer-button.green data-value="correct"
        ' YES
        div.answer-details = "#{ed} → #{ed+1} (~#{SRS_RANGES[ed+1>7 ? 7 : ed+1][1]} days)"
  //div.answer-block
  //  div style="display: inline-block;"
  //    div Meaning
  //  - unless @element.radical?
  //    div< style="display: inline-block;"
  //      div + Reading
  //      - if @element.kanji?
  //        div.reading-answer
  //          == slim :reading, locals: {e: @element}
  div.answer
    - if @progress.kind == 'w'
      - @word_seq = @progress.seq
      == slim :word
    - elsif @progress.kind == 'k'
      - @kanji = @progress.kanji
      == slim :kanji
    - elsif @progress.kind == 'r'
      - @radical = @progress.wk_radical
      == slim :wk_radical
  form id="answer-form" method="POST" action=path_to(:study).with(params[:class], params[:group])
    input type="hidden" name="id" value=@progress.id
    input type="hidden" name="answer" value=''

javascript:
  var is_answered = false;
  var answer_submitted = false;

  $(document).on('click', '.show-answer-button', function(){
    $('.answer').addClass('answer-revealed');
    $('.answer').removeClass('answer');
    $('.answer-block').hide();
    is_answered = true;
  });

  $(document).on('click', '.answer-button', function(){
    if (!answer_submitted) {
      answer_submitted = true;

      $(".answer-button").hide();
      $(".other-answers-button").hide();

      $("#answer-form input[name=answer]").val($(this).data('value'));
      $("#answer-form").submit();
    }
  });

  $(document).on('click', '.other-answers-button', function(){
    var oa = $('.other-answers');
    var p = $(this).offset();
    var pleft, ptop;

    console.log(oa.is(':visible'));
    if (oa.is(':visible')){
      oa.hide();
    } else {
      pleft = p.left + $(this).outerWidth()/2 - oa.outerWidth()/2;
      ptop = p.top + $(this).outerHeight() + 8;
      oa.attr("style", "left: " + pleft + "px; top: " + ptop + "px");

      oa.show();
    }
  });

  $(document).on('keyup', function (e) {
    if (is_answered) {
      if (e.keyCode == 89) { // [Y] key
        submitAnswer("yes");
      } else if (e.keyCode == 78) { // [N] key
        submitAnswer("no");
      } else if (e.keyCode == 83) { // [S] key
        submitAnswer("soso");
      } // there is no keybinding to 'burn' card
    } else {
      if (e.keyCode == 13 || e.keyCode == 32) { // Enter or Space
        showAnswer();
      }
    }
  });

